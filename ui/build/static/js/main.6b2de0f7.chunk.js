(this.webpackJsonppocassist=this.webpackJsonppocassist||[]).push([[0],{2162:function(e,t,a){},2175:function(e,t,a){},2329:function(e,t,a){},2337:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(12),c=a.n(r),o=(a(399),a(400),a(21)),i=a.n(o),u=(a(144),a(85)),s=a.n(u),d=(a(403),a(404),a(392)),m=a(68),p=a(34),f=(a(145),a(76)),v=a.n(f),E=a(8),b=(a(98),a(55)),h=a.n(b),O=(a(58),a(24)),g=a.n(O),y=(a(245),a(168)),j=a.n(y),C=(a(410),a(388)),w=a.n(C),S=(a(246),a(65)),k=a.n(S),T=(a(88),a(42)),A=a.n(T),I=(a(89),a(25)),N=a.n(I),x=a(384),D=a.n(x),P=a(2347),L=a(2348),F={collapsed:!1},_=l.a.createContext({state:F,dispatch:function(){}}),R=a(240),z=a.n(R),M=a(385),V=a(386),G=a.n(V),Q=a(178),H=a.n(Q),U=function(){return localStorage.getItem("token-key")},Y=function(){return JSON.parse(localStorage.getItem("userInfo"))},J=G.a.create({baseURL:"/api",timeout:"500000",withCredentials:!0,headers:{"Content-type":"application/json"},maxRedirects:0,paramsSerializer:function(e){for(var t in e)e[t]||(e[t]=null);var a=H.a.stringify(e,{skipNulls:!0});return H.a.stringify(H.a.parse(a),{arrayFormat:"repeat"})}});J.interceptors.request.use((function(e){return e.headers.Authorization="JWT ".concat(U()),e})),J.interceptors.response.use((function(e){var t,a=e.data;return a&&!a.code?(A.a.error((null===(t=e.data)||void 0===t?void 0:t.msg)||a.error),Promise.reject()):a}),function(){var e=Object(M.a)(z.a.mark((function e(t){var a;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 401===(null===(a=t.response)||void 0===a?void 0:a.status)&&(window.location.href="/"),A.a.error(t.toString()),e.abrupt("return",Promise.reject());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var B=J,q=v.a.Header,K=function(e){var t=Object(p.g)(),a=N.a.useForm(),r=Object(E.a)(a,1)[0],c=Object(n.useContext)(_),o=c.state,i=c.dispatch,u=Object(n.useState)(!1),s=Object(E.a)(u,2),d=s[0],m=s[1],f=l.a.createElement(k.a,null,l.a.createElement(k.a.Item,{onClick:function(){return m(!0)}},"\u4fee\u6539\u5bc6\u7801"),l.a.createElement(k.a.Item,{onClick:function(){B({url:"/v1/user/logout",method:"get"}).then((function(e){localStorage.removeItem("token-key"),t.push("/login")}))}},"\u9000\u51fa\u767b\u5f55"));return l.a.createElement(q,null,l.a.createElement("div",{className:"header-left-wrap"},l.a.createElement("div",{className:"header-left",onClick:function(){i({type:"TOGGLE_COLLAPSED"})}},o.collapsed?l.a.createElement(P.a,null):l.a.createElement(L.a,null))),l.a.createElement("div",{className:"header-right"},l.a.createElement(w.a,{size:32,src:D.a}),l.a.createElement(j.a,{overlayStyle:{width:"180px",zIndex:2e3},overlay:f},l.a.createElement("div",{className:"ant-dropdown-link"},l.a.createElement("div",null,"\u6b22\u8fce\uff0c",Y().name)))),l.a.createElement(h.a,{visible:d,onCancel:function(){return m(!1)},onOk:r.submit,title:"\u4fee\u6539\u5bc6\u7801",forceRender:!0},l.a.createElement(N.a,{form:r,onFinish:function(e){var t;(t={password:e.password,newpassword:e.newpassword},B({url:"/v1/user/self/resetpwd/",method:"post",data:t})).then((function(e){A.a.success("\u4fee\u6539\u5bc6\u7801\u6210\u529f"),m(!1)}))},labelCol:{span:6}},l.a.createElement(N.a.Item,{name:"password",label:"\u539f\u5bc6\u7801",rules:[{required:!0}]},l.a.createElement(g.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u539f\u5bc6\u7801"})),l.a.createElement(N.a.Item,{name:"newpassword",label:"\u65b0\u5bc6\u7801",rules:[{required:!0}]},l.a.createElement(g.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"})),l.a.createElement(N.a.Item,{name:"new_password_confirm",label:"\u518d\u6b21\u8f93\u5165\u5bc6\u7801",dependencies:["newpassword"],rules:[{required:!0,message:"\u8bf7\u518d\u6b21\u8f93\u5165\u5bc6\u7801"},function(e){var t=e.getFieldValue;return{validator:function(e,a){return a&&t("newpassword")!==a?Promise.reject("\u4e24\u6b21\u8f93\u5165\u65b0\u5bc6\u7801\u4e0d\u4e00\u81f4"):Promise.resolve()}}}]},l.a.createElement(g.a,{type:"password",placeholder:"\u8bf7\u518d\u6b21\u8f93\u5165\u65b0\u5bc6\u7801"})))))},X=(a(326),a(47)),Z=a(10),W=(a(623),a(389)),$=a.n(W),ee=(a(38),a(23)),te=a.n(ee),ae=a(46),ne=(a(625),a(43)),le=function(e){var t=N.a.useForm(),a=Object(E.a)(t,1)[0],r=Object(p.g)();return l.a.createElement("div",{className:"apply-login-wrap"},l.a.createElement("div",{className:"apply-login-page"},l.a.createElement("h2",{className:"login-title"},"POCASSIST"),l.a.createElement(N.a,Object.assign({},{labelCol:{span:24},wrapper:{span:24}},{form:a,onFinish:function(e){e.captcha_value;var t,a=Object(ae.a)(e,["captcha_value"]);(t=a,B({url:"/v1/user/login",method:"post",data:t})).then((function(e){var t;!function(e){localStorage.setItem("token-key",e)}(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.token),B({url:"/v1/user/info",method:"get"}).then((function(e){!function(e){localStorage.setItem("userInfo",JSON.stringify(e))}(e.data)})),r.push("/vul")}))},hideRequiredMark:!0,size:"large"}),l.a.createElement(n.Fragment,null,l.a.createElement(N.a.Item,{label:"\u7528\u6237",name:"username",rules:[{required:!0}]},l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",prefix:l.a.createElement(ne.MobileOutlined,null)})),l.a.createElement(N.a.Item,{label:"\u5bc6\u7801",name:"password",rules:[{required:!0}]},l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",maxLength:40,prefix:l.a.createElement(ne.UnlockOutlined,null),type:"password"}))),l.a.createElement(N.a.Item,{wrapperCol:{span:24}},l.a.createElement(te.a,{type:"primary",htmlType:"submit",block:!0},"\u767b\u5f55"))),l.a.createElement($.a,null),l.a.createElement("div",{className:"login-footer"},l.a.createElement("p",null,"Copyright https://github.com/jweny"))))},re=(a(2162),a(110),a(22)),ce=a.n(re),oe={search_query:{},page:1,pagesize:20,productList:[]},ie=l.a.createContext({state:oe,dispatch:function(){}}),ue=function(e){var t=N.a.useForm(),a=Object(E.a)(t,1)[0],r=Object(n.useContext)(ie),c=r.state,o=r.dispatch,i=[{name:"typeField",label:"\u6f0f\u6d1e\u7c7b\u578b",render:function(){var e;return l.a.createElement(ce.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200},allowClear:!0},null===(e=c.basic)||void 0===e?void 0:e.VulType.map((function(e){return l.a.createElement(ce.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"productField",label:"\u7ec4\u4ef6",render:function(){var e;return l.a.createElement(ce.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:120},allowClear:!0},null===(e=c.productList)||void 0===e?void 0:e.map((function(e){return l.a.createElement(ce.a.Option,{value:e.id,key:e.id},e.name)})))}},{name:"search",label:"\u6a21\u7cca\u67e5\u8be2"}];return l.a.createElement(N.a,{form:a,layout:"inline",className:"vul-manage-form",onFinish:function(e){o({type:"SET_SEARCH_QUERY",payload:e})}},i.map((function(e,t){var a=e.name,n=e.label,r=e.render,c=void 0===r?function(){return l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165".concat(n),allowClear:!0})}:r,o=Object(ae.a)(e,["name","label","render"]);return l.a.createElement(N.a.Item,Object.assign({label:n,key:t,name:a},o),c())})),l.a.createElement(te.a,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"))},se=(a(212),a(123)),de=a.n(se),me=(a(213),a(122)),pe=a.n(me),fe=(a(214),a(121)),ve=a.n(fe),Ee=(a(162),a(48)),be=a.n(Ee),he=(a(163),a(32)),Oe=a.n(he),ge=(a(339),a(120)),ye=a.n(ge),je=(a(2175),function(e){var t=e.className,a=e.columns,r=e.setColumns,c=e.allColumns,o=Object(n.useState)(!1),i=Object(E.a)(o,2),u=i[0],s=i[1],d=Object(n.useState)([]),m=Object(E.a)(d,2),p=m[0],f=m[1],v=Object(n.useState)({check:!1,indeterminate:!0}),b=Object(E.a)(v,2),O=b[0],g=b[1],y=Object(n.useCallback)((function(){f(a.map((function(e){return e.dataIndex}))),g({check:a.length===c.length,indeterminate:a.length>0&&a.length<c.length})}),[a,c]);Object(n.useEffect)((function(){y()}),[y]);var j=function(){s((function(e){return!e}))};return l.a.createElement("div",{className:t+" custom-columns-wrap"},l.a.createElement(te.a,{type:"link",onClick:j},"\u81ea\u5b9a\u4e49"),l.a.createElement(h.a,{visible:u,title:"\u81ea\u5b9a\u4e49\u8868\u5934",onCancel:function(){s(!1),y()},onOk:function(){var e=c.filter((function(e){return-1!==p.indexOf(e.dataIndex)}));r(e),j()},width:800,wrapClassName:"custom-columns-modal"},l.a.createElement("div",{className:"site-checkbox-all-wrapper"},l.a.createElement(ye.a,{indeterminate:O.indeterminate,onChange:function(e){var t=e.target.checked;g({indeterminate:!1,check:t}),f(t?c.map((function(e){return e.dataIndex})):[])},checked:O.check},"\u5168\u9009")),l.a.createElement(ye.a.Group,{name:"columns",value:p,onChange:function(e){f(e),g({check:e.length===c.length,indeterminate:e.length>0&&e.length<c.length})},style:{width:"100%"}},l.a.createElement(be.a,null,c.map((function(e){return l.a.createElement(Oe.a,{span:6,key:e.dataIndex},l.a.createElement(ye.a,{value:e.dataIndex},e.title))}))))))}),Ce=[{name:"description",label:"\u63cf\u8ff0"},{name:"suggestion",label:"\u4fee\u590d\u5efa\u8bae"}],we=(a(2176),a(238)),Se=a.n(we),ke=function(e){return B({url:"/v1/product/",method:"get",params:e})},Te=function(e){return B({url:"/v1/vul/",method:"get",params:e})},Ae=function(){return B({url:"/v1/vul/basic/",method:"get"})},Ie=function(e){return B({url:"/v1/vul/",method:"post",data:e})},Ne=function(e,t){return B({url:"/v1/vul/".concat(t,"/"),method:"put",data:e})},xe=a(243),De=a.n(xe),Pe=(a(372),[{name:"name",label:"\u7ec4\u4ef6\u540d\u79f0",rules:[{required:!0}]},{name:"provider",label:"\u5382\u5546"},{name:"remarks",label:"\u5907\u6ce8",render:function(){return l.a.createElement(g.a.TextArea,null)}}]),Le=function(e){var t,a=e.type,r=e.selected,c=N.a.useForm(),o=Object(E.a)(c,1)[0];switch(Object(n.useEffect)((function(){o.resetFields()}),[r,o]),a){case"product":t=Pe;break;default:t=Pe}return l.a.createElement(h.a,Object.assign({},e,{forceRender:!0,title:(r?"\u7f16\u8f91":"\u65b0\u589e")+("script"===a?"\u811a\u672c":"product"===a?"\u7ec4\u4ef6":"\u6a21\u5757"),footer:l.a.createElement("div",null,l.a.createElement(te.a,{type:"primary",onClick:o.submit},r?"\u4fdd\u5b58":"\u6dfb\u52a0"),l.a.createElement(te.a,{onClick:e.onCancel},"\u53d6\u6d88"))}),l.a.createElement(N.a,Object.assign({},{labelCol:{span:6},wrapperCol:{span:16}},{form:o,onFinish:function(t){e.onOk&&e.onOk(t)},initialValues:r||{}}),t.map((function(e,t){var a=e.name,n=e.label,r=e.render,c=void 0===r?function(){return l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165".concat(n)})}:r,o=Object(ae.a)(e,["name","label","render"]);return l.a.createElement(N.a.Item,Object.assign({label:n,key:t,name:a},o),c())}))))},Fe=function(e){var t=e.selected,a=e.type,r=void 0===a?"vul":a,c=Object(n.useRef)(null),o=Object(n.useState)(1),i=Object(E.a)(o,2),u=i[0],d=i[1],m=Object(n.useState)(null),p=Object(E.a)(m,2),f=p[0],v=p[1],b=Object(n.useState)(void 0),O=Object(E.a)(b,2),y=O[0],j=O[1],C=Object(n.useState)(!0),w=Object(E.a)(C,2),S=w[0],k=w[1],T=Object(n.useContext)(ie),I=T.state,x=T.dispatch,D=Object(n.useState)(!1),P=Object(E.a)(D,2),L=P[0],F=P[1],_=N.a.useForm(),R=Object(E.a)(_,1)[0];Object(n.useEffect)((function(){t?(v(t),d(1),k(!1)):k(!1)}),[t,r]);var z=[{name:"webapp",label:"\u5f71\u54cd\u7ec4\u4ef6",render:function(){var e;return l.a.createElement(ce.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200},onSelect:function(e){"new"===e&&F(!0)}},null===(e=I.productList)||void 0===e?void 0:e.map((function(e){return l.a.createElement(ce.a.Option,{value:e.id,key:e.id},e.name)})),l.a.createElement(ce.a.Option,{value:"new"},"\u65b0\u589e ",l.a.createElement(ne.PlusOutlined,null)))}},{name:"severity",label:"\u6f0f\u6d1e\u7b49\u7ea7",render:function(){var e;return l.a.createElement(ce.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200}},null===(e=I.basic)||void 0===e?void 0:e.VulLevel.map((function(e){return l.a.createElement(ce.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"category",label:"\u6f0f\u6d1e\u7c7b\u578b",render:function(){var e;return l.a.createElement(ce.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200}},null===(e=I.basic)||void 0===e?void 0:e.VulType.map((function(e){return l.a.createElement(ce.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"language",label:"\u6f0f\u6d1e\u8bed\u8a00",render:function(){var e;return l.a.createElement(ce.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200}},null===(e=I.basic)||void 0===e?void 0:e.VulLanguage.map((function(e){return l.a.createElement(ce.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"cve",label:"CVE\u7f16\u53f7"},{name:"cnnvd",label:"CNNVD\u7f16\u53f7"}],M=["font-size","line-height","letter-spacing","headings","text-indent","text-align","emoji","hr","separator"],V=document.documentElement.offsetHeight;return l.a.createElement(h.a,Object.assign({},e,{destroyOnClose:!0,maskClosable:!1,onCancel:function(t){var a;2===(a=1)?R.validateFields().then((function(e){d(a)})).catch((function(){})):d(a),e.onCancel&&e.onCancel(t)},footer:l.a.createElement("div",null,1===u&&l.a.createElement(l.a.Fragment,null,l.a.createElement(te.a,{type:"primary",onClick:function(){R.validateFields().then((function(e){var t=Object(Z.a)({},e);Ce.map((function(a){t[a.name]=e[a.name]&&"object"===typeof e[a.name]?e[a.name].toHTML():e[a.name]})),v((function(e){return Object(Z.a)({},e,{},t)})),console.log(Object(Z.a)({},f,{},t)),function(e){var t;k(!0);var a=Y(),n=(null===f||void 0===f?void 0:f.id)||y?Ne:Ie,l=null===(t=c.current)||void 0===t?void 0:t.getRunTestData();n(Object(Z.a)({},f,{},e,{writer_id:null===a||void 0===a?void 0:a.id},l),(null===f||void 0===f?void 0:f.id)||y).then((function(e){j(e.data.id),A.a.success("\u4fdd\u5b58\u6210\u529f"),Te(Object(Z.a)({},I.search_query,{page:I.page,pagesize:I.pagesize})).then((function(e){x({type:"SET_LIST",payload:e.data.data}),x({type:"SET_TOTAL",payload:e.data.total})}))})).finally((function(){k(!1)}))}(Object(Z.a)({},f,{},t))})).catch((function(e){}))}},"\u4fdd\u5b58")),l.a.createElement(te.a,{onClick:e.onCancel},"\u53d6\u6d88")),bodyStyle:{maxHeight:V-120,overflowY:"scroll"}}),l.a.createElement(s.a,{spinning:S},l.a.createElement(N.a,Object.assign({},{labelCol:{span:6},wrapperCol:{span:16}},{form:R,name:"vul_detail",layout:"horizontal",initialValues:f,style:{display:"".concat(1===u?"flex":"none")}}),l.a.createElement(N.a.Item,{name:"name_zh",label:"\u6f0f\u6d1e\u540d\u79f0",rules:[{required:!0}],className:"form-item-long",labelCol:{span:3},wrapperCol:{span:20}},l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u6f0f\u6d1e\u540d\u79f0"})),z.map((function(e,t){var a=e.name,n=e.label,r=e.render,c=void 0===r?function(){return l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165".concat(n)})}:r,o=Object(ae.a)(e,["name","label","render"]);return l.a.createElement(N.a.Item,Object.assign({label:n,key:t,name:a},o),c())})),l.a.createElement(be.a,{style:{width:"100%",marginBottom:24}},l.a.createElement(Oe.a,{offset:3},l.a.createElement(Se.a,{message:"\u6ce8\u610f\u4ee5\u4e0b\u4e3a\u5bcc\u6587\u672c\uff1a\u590d\u5236\u7c98\u8d34\u6765\u7684\u6587\u672c\u5148\u6e05\u9664\u683c\u5f0f"}))),Ce.map((function(e,t){var a=e.name,n=e.label,r=Object(ae.a)(e,["name","label"]);return l.a.createElement(N.a.Item,Object.assign({label:n,key:t,name:a,labelCol:{span:3},wrapperCol:{span:20},validateTrigger:"onBlur",getValueProps:function(e){return{value:De.a.createEditorState(e)}},className:"form-item-long"},r),l.a.createElement(De.a,{excludeControls:M,placeholder:"\u8bf7\u8f93\u5165".concat(n),style:{border:"1px solid #ccc"},contentStyle:{height:200,overflow:"auto"}}))})))),l.a.createElement(Le,{visible:L,onCancel:function(){F(!1)},onOk:function(e){var t;(t=e,B({url:"/v1/product/",method:"post",data:t})).then((function(e){F(!1),ke({page:1,pagesize:9999}).then((function(e){x({type:"SET_PRODUCT_LIST",payload:e.data.data})})),R.setFieldsValue({product:e.data.id})}))},type:"product",selected:void 0}))},_e=function(e){var t=[{title:"\u6f0f\u6d1e\u540d\u79f0",dataIndex:"name_zh",ellipsis:!1,width:"30%"},{title:"\u5f71\u54cd\u7ec4\u4ef6",dataIndex:"webapp_name",ellipsis:!0},{title:"\u6f0f\u6d1e\u7c7b\u578b",dataIndex:"category",ellipsis:!0},{title:"cve\u7f16\u53f7",dataIndex:"cve",ellipsis:!0},{title:"cnnvd\u7f16\u53f7",dataIndex:"cnnvd",ellipsis:!0},{title:"\u4fee\u590d\u5efa\u8bae",dataIndex:"suggestion",ellipsis:!0},{title:"\u6f0f\u6d1e\u7ea7\u522b",dataIndex:"severity",ellipsis:!0,render:function(e){switch(e){case"high":return"\u9ad8\u5371";case"middle":return"\u4e2d\u5371";case"low":return"\u4f4e\u5371";case"info":return"\u4fe1\u606f";default:return""}}},{title:"\u6f0f\u6d1e\u8bed\u8a00",dataIndex:"language",ellipsis:!0},{title:"\u4e0a\u4f20\u8005",dataIndex:"writer_name",ellipsis:!0}],a=Object(n.useState)(!1),r=Object(E.a)(a,2),c=r[0],o=r[1],i=Object(n.useState)(Object(X.a)(t.slice(0,4))),u=Object(E.a)(i,2),s=u[0],d=u[1],m=Object(n.useState)(!1),p=Object(E.a)(m,2),f=p[0],v=p[1],b=Object(n.useState)(void 0),h=Object(E.a)(b,2),O=h[0],g=h[1],y=Object(n.useContext)(ie),j=y.state,C=y.dispatch,w=function(){o(!0),Te(Object(Z.a)({},j.search_query,{page:j.page,pagesize:j.pagesize})).then((function(e){C({type:"SET_LIST",payload:e.data.data}),C({type:"SET_TOTAL",payload:e.data.total})})).finally((function(){o(!1)}))};Object(n.useEffect)((function(){w()}),[j.page,j.pagesize,j.search_query]);var S=[{title:"\u5e8f\u53f7",dataIndex:"order",render:function(e,t,a){return a+1}}].concat(Object(X.a)(s),[{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(te.a,{type:"link",onClick:function(){var e;o(!0),(e=t.id,B({url:"/v1/vul/".concat(e,"/"),method:"get"})).then((function(e){g(e.data||t),k()})).finally((function(){o(!1)}))}},"\u8be6\u60c5"),l.a.createElement(ve.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u6761\u6f0f\u6d1e\u5417\uff1f",onCancel:function(){},onConfirm:function(){T(t.id)}},l.a.createElement(te.a,{type:"link"},"\u5220\u9664")))}}]),k=function(){v((function(e){return e&&g(void 0),!e}))},T=function(e){o(!0),function(e){return B({url:"/v1/vul/".concat(e,"/"),method:"delete"})}(e).then((function(e){A.a.success("\u5220\u9664\u6210\u529f"),w()})).finally((function(){o(!1)}))},I=document.documentElement.offsetWidth;return l.a.createElement("div",{className:"vul-manage-table"},l.a.createElement("div",{className:"vul-controller"},l.a.createElement(pe.a,null,l.a.createElement(te.a,{icon:l.a.createElement(ne.PlusOutlined,null),type:"primary",onClick:k},"\u65b0\u5efa\u63cf\u8ff0")),l.a.createElement(je,{className:"custom-btn",allColumns:t,columns:s,setColumns:d})),l.a.createElement(de.a,{columns:S,dataSource:j.list,rowKey:"id",loading:c,pagination:{current:j.page,pageSize:j.pagesize,total:j.total,showTotal:function(e){return"\u5171".concat(e,"\u6761")},showQuickJumper:!0,showSizeChanger:!0,onChange:function(e,t){C({type:"SET_PAGINATION",payload:{page:e,pagesize:t}})}}}),f&&l.a.createElement(Fe,{visible:f,onCancel:k,title:O?"\u6f0f\u6d1e\u63cf\u8ff0\u8be6\u60c5":"\u65b0\u5efa\u6f0f\u6d1e\u63cf\u8ff0",width:I,wrapClassName:"add-vul-wrap",selected:O,type:"vul"}))},Re=function(e,t){var a=t.type,n=t.payload;switch(a){case"SET_SEARCH_QUERY":return Object(Z.a)({},e,{search_query:n,page:1});case"SET_PAGINATION":return Object(Z.a)({},e,{page:n.page,pagesize:n.pagesize});case"SET_BASIC":return Object(Z.a)({},e,{basic:n});case"SET_LIST":return Object(Z.a)({},e,{list:n});case"SET_TOTAL":return Object(Z.a)({},e,{total:n});case"SET_MODULE_LIST":return Object(Z.a)({},e,{moduleList:n});case"SET_SCRIPT_LIST":return Object(Z.a)({},e,{scriptList:n});case"SET_PRODUCT_LIST":return Object(Z.a)({},e,{productList:n});default:throw new Error("action type error")}},ze=function(e){var t=Object(n.useReducer)(Re,oe),a=Object(E.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){Ae().then((function(e){c({type:"SET_BASIC",payload:e.data})})),ke({page:1,pagesize:9999}).then((function(e){c({type:"SET_PRODUCT_LIST",payload:e.data.data})}))}),[]),l.a.createElement(ie.Provider,{value:{state:r,dispatch:c}},l.a.createElement("div",{className:"vul-manage-wrap"},l.a.createElement(ue,null),l.a.createElement(_e,null)))},Me=(a(2329),{search_query:{},page:1,pagesize:20,flag:!1,productList:[]}),Ve=l.a.createContext({state:Me,dispatch:function(){}}),Ge=function(e){var t=N.a.useForm(),a=Object(E.a)(t,1)[0],r=Object(n.useContext)(Ve),c=r.state,o=r.dispatch,i=[{name:"enableField",label:"\u662f\u5426\u542f\u7528",render:function(){return l.a.createElement(ce.a,{placeholder:"\u72b6\u6001",style:{width:120},allowClear:!0},l.a.createElement(ce.a.Option,{value:"True"},"\u542f\u7528"),l.a.createElement(ce.a.Option,{value:"False"},"\u7981\u7528"))}},{name:"affectsField",label:"\u5f71\u54cd\u7c7b\u578b",render:function(){var e;return l.a.createElement(ce.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200},allowClear:!0},null===(e=c.basic)||void 0===e?void 0:e.ModuleAffects.map((function(e){return l.a.createElement(ce.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"search",label:"\u6a21\u7cca\u67e5\u8be2"}];return l.a.createElement(N.a,{form:a,layout:"inline",className:"vul-manage-form",onFinish:function(e){o({type:"SET_SEARCH_QUERY",payload:e})}},i.map((function(e,t){var a=e.name,n=e.label,r=e.render,c=void 0===r?function(){return l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165".concat(n),allowClear:!0})}:r,o=Object(ae.a)(e,["name","label","render"]);return l.a.createElement(N.a.Item,Object.assign({label:n,key:t,name:a},o),c())})),l.a.createElement(te.a,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"))},Qe=(a(381),a(176)),He=a.n(Qe),Ue=a(391),Ye=a.n(Ue),Je=(a(338),a(124)),Be=a.n(Je),qe=a(119),Ke=(a(2331),a(244)),Xe=a.n(Ke),Ze=function(e){var t,a,n=function(t){var a;null===(a=e.onChange)||void 0===a||a.call(e,Object(Z.a)({},e.value,{},t))};return l.a.createElement("div",{className:e.className},l.a.createElement(g.a.Group,{compact:!0,style:{width:"92%",float:"left"}},l.a.createElement(g.a,{style:{width:"20%"},name:"key",value:null===e||void 0===e||null===(t=e.value)||void 0===t?void 0:t.key,onChange:function(e){n({key:e.target.value})},onBlur:e.handleBlur}),l.a.createElement(g.a,{style:{width:"80%"},name:"value",value:null===e||void 0===e||null===(a=e.value)||void 0===a?void 0:a.value,onChange:function(e){n({value:e.target.value})},onBlur:e.handleBlur})),l.a.createElement(ne.PlusCircleOutlined,{className:"dynamic-delete-button color-grey",type:"plus-circle-o",onClick:e.handleAdd}),e.showDeleteButton&&l.a.createElement(ne.MinusCircleOutlined,{className:"dynamic-delete-button color-red",type:"minus-circle-o",style:{color:"#ff6868"},onClick:function(){var t;return null===(t=e.handleDelete)||void 0===t?void 0:t.call(e,e.value.id)}}))};Ze.defaultProps={showAddButton:!0,showDeleteButton:!0};var We=Ze,$e=function(e){console.log(e);var t=e.data,a=Object(n.useState)([{id:at()}]),r=Object(E.a)(a,2),c=r[0],o=r[1];Object(n.useEffect)((function(){if(t.headers)if(Object.keys(t.headers).length>0){var e=Object.keys(t.headers).map((function(e){return{key:e,value:t.headers[e],id:at()}}));o(e)}else o([{id:at()}])}),[t]);var i=function(){o((function(e){return[].concat(Object(X.a)(e),[{id:at()}])}))},u=function(e){o((function(t){return t.filter((function(t){return t.id!==e}))}))};return l.a.createElement("div",null,l.a.createElement(be.a,{className:"run-test-items"},l.a.createElement(Oe.a,{span:4},"\u8bf7\u6c42\u65b9\u6cd5 method\uff1a"),l.a.createElement(Oe.a,{span:14,offset:1},l.a.createElement(ce.a,{value:null===t||void 0===t?void 0:t.method,onChange:function(a){return e.setData(t.id,"method",a)},style:{width:"100%"}},l.a.createElement(ce.a.Option,{value:"GET"},"GET"),l.a.createElement(ce.a.Option,{value:"OPTIONS"},"OPTIONS"),l.a.createElement(ce.a.Option,{value:"HEAD"},"HEAD"),l.a.createElement(ce.a.Option,{value:"POST"},"POST"),l.a.createElement(ce.a.Option,{value:"PUT"},"PUT"),l.a.createElement(ce.a.Option,{value:"DELETE"},"DELETE"),l.a.createElement(ce.a.Option,{value:"PROPRFIND"},"PROPRFIND"),l.a.createElement(ce.a.Option,{value:"TRACE"},"TRACE"),l.a.createElement(ce.a.Option,{value:"CONNECT"},"CONNECT"),l.a.createElement(ce.a.Option,{value:"MOVE"},"MOVE"),l.a.createElement(ce.a.Option,{value:"TRACK"},"TRACK")))),l.a.createElement(be.a,{className:"run-test-items"},l.a.createElement(Oe.a,{span:4},"\u8bf7\u6c42\u8def\u5f84 path\uff1a"),l.a.createElement(Oe.a,{span:14,offset:1},l.a.createElement(g.a,{value:null===t||void 0===t?void 0:t.path,onChange:function(a){return e.setData(t.id,"path",a.target.value)}}))),l.a.createElement(be.a,{className:"run-test-items"},l.a.createElement(Oe.a,{span:4},"\u8bf7\u6c42\u5934 headers\uff1a"),l.a.createElement(Oe.a,{span:14,offset:1},c.map((function(e){return l.a.createElement(We,{key:e.id,value:e,handleAdd:i,handleDelete:u,onChange:function(e){return function(e){console.log(e),o((function(t){return t.map((function(t){return t.id===e.id?e:t}))}))}(e)},showDeleteButton:c.length>1,className:"header-input-group"})})),l.a.createElement(te.a,{onClick:function(){var a={};c.forEach((function(e){console.log(e),e.key&&(a[e.key]=e.value)})),console.log(a),e.setData(t.id,"headers",a),A.a.success("\u4fdd\u5b58\u8bf7\u6c42\u5934\u6210\u529f")},type:"primary",ghost:!0},"\u4fdd\u5b58\u8bf7\u6c42\u5934"),l.a.createElement("span",{style:{color:"red",marginLeft:"10px"}},"\u6ce8\u610f\uff1a\u586b\u5199\u5b8c\u8bf7\u6c42\u5934\u540e\u8bf7\u70b9\u51fb\u8be5\u6309\u94ae\uff0c\u5426\u5219\u4e0d\u4f1a\u4fdd\u5b58\u8bf7\u6c42\u5934\uff01"))),l.a.createElement(be.a,{className:"run-test-items"},l.a.createElement(Oe.a,{span:4},"\u8bf7\u6c42\u4f53 body\uff1a"),l.a.createElement(Oe.a,{span:14,offset:1},l.a.createElement(g.a.TextArea,{value:null===t||void 0===t?void 0:t.body,onChange:function(a){return e.setData(t.id,"body",a.target.value)}}))),l.a.createElement(be.a,{className:"run-test-items"},l.a.createElement(Oe.a,{span:4},"\u5141\u8bb8\u8df3\u8f6c follow_redirects\uff1a"),l.a.createElement(Oe.a,{span:14,offset:1},l.a.createElement(He.a,{checked:null===t||void 0===t?void 0:t.follow_redirects,onChange:function(a){return e.setData(t.id,"follow_redirects",a)}}))),l.a.createElement(be.a,{className:"run-test-items"},l.a.createElement(Oe.a,{span:4},"\u63d0\u53d6\u89c4\u5219 search\uff1a"),l.a.createElement(Oe.a,{span:14,offset:1},l.a.createElement(g.a.TextArea,{value:null===t||void 0===t?void 0:t.search,onChange:function(a){return e.setData(t.id,"search",a.target.value)}}))),l.a.createElement(be.a,{className:"run-test-items"},l.a.createElement(Oe.a,{span:4},"\u8868\u8fbe\u5f0f expression\uff1a"),l.a.createElement(Oe.a,{span:14,offset:1},l.a.createElement(g.a.TextArea,{value:null===t||void 0===t?void 0:t.expression,onChange:function(a){return e.setData(t.id,"expression",a.target.value)}}))))},et=function(e){var t=e.data,a=function(a,n,l){var r=Object(Z.a)({},t,{data:t.data.map((function(e){return e.id===a?Object(Z.a)({},e,Object(qe.a)({},n,l)):e}))});e.setData(r)},n=function(){var a=Object(Z.a)({},t,{data:[].concat(Object(X.a)(t.data),[{id:at()}])});e.setData(a)},r=function(a){console.log(a);var n=Object(Z.a)({},t,{data:t.data.filter((function(e){return e.id!==a}))});e.setData(n)};return l.a.createElement("div",{className:"test-component-wrap"},"groups"===e.type&&l.a.createElement(g.a,{value:t.name,style:{width:"200px",margin:"10px 0"},onChange:function(a){return function(a){var n=Object(Z.a)({},t,{name:a});e.setData(n)}(a.target.value)}}),l.a.createElement(Xe.a,{type:"editable-card",defaultActiveKey:"1",onEdit:function(e,t){"add"===t?n():h.a.confirm({title:"\u771f\u7684\u5220\u9664\uff1f",onOk:function(){r(e)}})},tabBarExtraContent:l.a.createElement(pe.a,null,"groups"===e.type&&l.a.createElement(ve.a,{title:"\u771f\u7684\u5220\u9664\uff1f",onConfirm:function(){e.delete(t.id)}},l.a.createElement(te.a,{type:"link",danger:!0},"\u5220\u9664rules")))},t.data.map((function(e,t){return l.a.createElement(Xe.a.TabPane,{tab:"rule",key:e.id},l.a.createElement($e,{data:e,setData:a}))}))))},tt=l.a.forwardRef((function(e,t){var a=e.testData,r=(e.vulId,Object(n.useState)([])),c=Object(E.a)(r,2),o=c[0],i=c[1],u=Object(n.useState)([]),s=Object(E.a)(u,2),d=s[0],m=s[1],p=Object(n.useState)([]),f=Object(E.a)(p,2),v=f[0],b=f[1],h=Object(n.useState)({name:"",type:"rules"}),O=Object(E.a)(h,2),y=O[0],j=O[1],C=Object(n.useState)([]),w=Object(E.a)(C,2),S=(w[0],w[1],Object(n.useState)(!1)),k=Object(E.a)(S,2),T=(k[0],k[1],Object(n.useState)(!1)),A=Object(E.a)(T,2);A[0],A[1];Object(n.useEffect)((function(){if(a){console.log(a);var e=a.set?Object.keys(a.set).map((function(e){return{name:e,value:a.set[e]}})):[],t=I(a.rules||[]),n=N(a.groups||{});i(t),a.hasOwnProperty("rules")?m([{name:"rules",data:t,id:at()}]):m(n),b((null===e||void 0===e?void 0:e.map((function(e){return Object(Z.a)({},e,{key:at()})})))||[]),j({name:a.name,type:a.hasOwnProperty("rules")?"rules":"groups"})}else m([{name:"rules",data:[{id:at()}],id:at()}])}),[a]);var I=function(e){return e.map((function(e){return Object(Z.a)({},e,{id:at()})}))},N=function(e){return Object.keys(e).map((function(t){return{name:t,data:e[t].map((function(e){return Object(Z.a)({},e,{id:at()})})),id:at()}}))},x=function(e){console.log(e);var t=d.map((function(t){return t.id===e.id?e:t}));m(t)},D=function(e){var t=d.filter((function(t){return t.id!==e}));m(t)},P=[{title:"name",dataIndex:"name",render:function(e,t){return l.a.createElement(g.a,{value:e,onChange:function(e){return F(e.target.value,"name",t)}})}},{title:"value",dataIndex:"value",render:function(e,t){return l.a.createElement(g.a,{value:e,onChange:function(e){return F(e.target.value,"value",t)}})}},{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(e,t){return l.a.createElement(te.a,{type:"link",icon:l.a.createElement(ne.DeleteOutlined,null),onClick:function(){return L(t.key)}})}}],L=function(e){b((function(t){return t.filter((function(t){return t.key!==e}))}))},F=function(e,t,a){b((function(n){return n.map((function(n){return n.key===a.key?Object(Z.a)({},n,Object(qe.a)({},t,e)):n}))}))},_=Object(n.useCallback)((function(){console.log(o,"------",d,"--------",v);var e={};if(e.name=y.name,e.set=function(e){var t={};return e.forEach((function(e){t[e.name]=e.value})),t}(v),"rules"===y.type){var t,a;e.rules=null===(t=d[0])||void 0===t||null===(a=t.data)||void 0===a?void 0:a.map((function(e){e.id;return Object(ae.a)(e,["id"])}))}else{var n={};d.forEach((function(e){n[e.name]=e.data})),e.groups=n}return{json_poc:e}}),[o,v,y,d]);return Object(n.useImperativeHandle)(t,(function(){return{getRunTestData:_}}),[_]),l.a.createElement("div",{style:e.style,className:"run-test-wrap"},l.a.createElement(be.a,null,l.a.createElement(Oe.a,{span:3,className:"rt-url-label"},"\u540d\u79f0\uff1a"),l.a.createElement(Oe.a,{span:14},l.a.createElement(g.a,{value:null===y||void 0===y?void 0:y.name,onChange:function(e){e.persist(),j((function(t){return Object(Z.a)({},t,{name:e.target.value})}))}}))),l.a.createElement(be.a,null,l.a.createElement(Oe.a,{span:3,className:"rt-url-label"},"\u89c4\u5219\u7c7b\u578b\uff1a"),l.a.createElement(Oe.a,{span:14},l.a.createElement(Be.a.Group,{onChange:function(e){j((function(t){return Object(Z.a)({},t,{type:e.target.value})}))},value:null===y||void 0===y?void 0:y.type},l.a.createElement(Be.a,{value:"rules"},"rules"),l.a.createElement(Be.a,{value:"groups"},"groups")))),l.a.createElement(te.a,{type:"link",onClick:function(){b((function(e){return[].concat(Object(X.a)(e),[{key:at()}])}))}},"\u6dfb\u52a0\u53d8\u91cf ",l.a.createElement(ne.PlusOutlined,null)),"groups"===y.type&&l.a.createElement(te.a,{type:"link",onClick:function(){m([].concat(Object(X.a)(d),[{name:"rules",data:[{id:at()}],id:at()}]))}},"\u6dfb\u52a0rules ",l.a.createElement(ne.PlusOutlined,null)),(null===v||void 0===v?void 0:v.length)>0&&l.a.createElement(de.a,{dataSource:v,pagination:!1,columns:P}),null===d||void 0===d?void 0:d.map((function(e,t){return e&&l.a.createElement(et,{data:e,type:y.type,setData:x,delete:D,key:t})})))}));function at(){return(new Date).getTime()+""+Math.floor(1e4*Math.random())}var nt=function(e){return B({url:"/v1/poc/",method:"get",params:e})},lt=function(e){return B({url:"/v1/poc/",method:"post",data:e})},rt=function(e,t){return B({url:"/v1/poc/".concat(t,"/"),method:"put",data:e})},ct=function(e){var t,a=e.selected,r=e.type,c=void 0===r?"vul":r,o=Object(n.useRef)(null),i=Object(n.useState)(1),u=Object(E.a)(i,2),d=(u[0],u[1]),m=Object(n.useState)(null),p=Object(E.a)(m,2),f=p[0],v=p[1],b=Object(n.useState)([]),O=Object(E.a)(b,2),y=O[0],j=O[1],C=Object(n.useState)(void 0),w=Object(E.a)(C,2),S=w[0],k=w[1],T=Object(n.useState)(!0),I=Object(E.a)(T,2),x=I[0],D=I[1],P=Object(n.useState)(!1),L=Object(E.a)(P,2),F=L[0],_=L[1],R=Object(n.useState)(""),z=Object(E.a)(R,2),M=z[0],V=z[1],G=Object(n.useState)(""),Q=Object(E.a)(G,2),H=Q[0],U=Q[1],J=Object(n.useContext)(Ve),q=J.state,K=J.dispatch,X=N.a.useForm(),W=Object(E.a)(X,1)[0];Object(n.useEffect)((function(){a?(v(a),d(1),D(!1)):D(!1),Te({page:1,pagesize:99999}).then((function(e){j(e.data.data)}))}),[a,c]);var $=function(e){var t;_(!0),D(!0);var a,n=Y(),l=null===(t=o.current)||void 0===t?void 0:t.getRunTestData(),r=Object(Z.a)({target:H},f,{},e,{writer_id:null===n||void 0===n?void 0:n.id},l);(a=r,B({url:"/v1/poc/run/",method:"post",data:a})).then((function(e){V(e.data)})).finally((function(){D(!1)}))},ee=[{name:"vul_id",label:"\u6f0f\u6d1e\u7f16\u53f7(poc-db-)"},{name:"affects",label:"\u89c4\u5219\u7c7b\u578b",render:function(){var e;return l.a.createElement(ce.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:300}},null===(e=q.basic)||void 0===e?void 0:e.ModuleAffects.map((function(e){return l.a.createElement(ce.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"enable",label:"\u662f\u5426\u542f\u7528",valuePropName:"checked",render:function(){return l.a.createElement(He.a,null)}},{name:"description",label:"\u6f0f\u6d1e\u63cf\u8ff0",render:function(){return l.a.createElement(ce.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:300},showSearch:!0,optionFilterProp:"children"},y.map((function(e){return l.a.createElement(ce.a.Option,{value:e.id,key:e.id,title:e.name_zh},e.name_zh)})))}}],ne=document.documentElement.offsetHeight;return l.a.createElement(h.a,Object.assign({},e,{destroyOnClose:!0,maskClosable:!1,onCancel:function(t){e.onCancel&&e.onCancel(t)},footer:l.a.createElement("div",null,l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{float:"left",lineHeight:"32px"}},"\u6d4b\u8bd5url\uff1a"),l.a.createElement(g.a,{style:{float:"left",width:"400px"},onChange:function(e){return U(e.target.value)}}),l.a.createElement(te.a,{type:"primary",style:{float:"left",marginLeft:"10px"},onClick:function(){W.validateFields().then((function(e){$(e)}))},loading:x},"\u6d4b\u8bd5\u89c4\u5219"),l.a.createElement(te.a,{type:"primary",onClick:function(){W.validateFields().then((function(e){!function(e){var t;console.log(e),D(!0);var a=Y(),n=(null===f||void 0===f?void 0:f.id)||S?rt:lt,l=null===(t=o.current)||void 0===t?void 0:t.getRunTestData(),r=Object(Z.a)({},f,{},e,{writer_id:null===a||void 0===a?void 0:a.id},l);console.log(r),n(r,(null===f||void 0===f?void 0:f.id)||S).then((function(e){k(e.data.id),A.a.success("\u4fdd\u5b58\u6210\u529f"),nt(Object(Z.a)({},q.search_query,{page:q.page,pagesize:q.pagesize})).then((function(e){K({type:"SET_LIST",payload:e.data.data}),K({type:"SET_TOTAL",payload:e.data.total})}))})).finally((function(){D(!1)}))}(e)}))},loading:x},"\u4fdd\u5b58")),l.a.createElement(te.a,{onClick:e.onCancel},"\u53d6\u6d88")),bodyStyle:{maxHeight:ne-120,overflowY:"scroll"}}),l.a.createElement(s.a,{spinning:x},l.a.createElement(N.a,Object.assign({},{labelCol:{span:6},wrapperCol:{span:16}},{form:W,name:"vul_detail",layout:"horizontal",initialValues:f}),ee.map((function(e,t){var a=e.name,n=e.label,r=e.render,c=void 0===r?function(){return l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165".concat(n)})}:r,o=Object(ae.a)(e,["name","label","render"]);return l.a.createElement(N.a.Item,Object.assign({label:n,key:t,name:a},o),c())}))),l.a.createElement("h3",{className:"poc_title"},"\u89c4\u5219\u5185\u5bb9\uff1a"),l.a.createElement(tt,{ref:o,testData:null===f||void 0===f?void 0:f.json_poc,vulId:null!==(t=null===f||void 0===f?void 0:f.id)&&void 0!==t?t:S})),l.a.createElement(h.a,{visible:F,width:800,footer:null,onCancel:function(){_(!1),V([])},title:"poc\u8fd0\u884c\u7ed3\u679c",className:"test-result-wrap"},l.a.createElement(s.a,{spinning:x,size:"large"},l.a.createElement(Ye.a,{src:M,name:!1,displayDataTypes:!1}))))},ot=function(e){var t=[{title:"\u6f0f\u6d1e\u7f16\u53f7",dataIndex:"vul_id",ellipsis:!1},{title:"\u72b6\u6001",dataIndex:"enable",ellipsis:!0,render:function(e){return e?"\u542f\u7528":"\u7981\u7528"}},{title:"poc\u540d\u79f0",dataIndex:"json_poc",ellipsis:!1,render:function(e){return e.name}},{title:"\u6f0f\u6d1e\u540d",dataIndex:"desp_name",ellipsis:!0},{title:"\u5f71\u54cd\u7c7b\u578b",dataIndex:"affects",ellipsis:!0}],a=Object(n.useState)(!1),r=Object(E.a)(a,2),c=r[0],o=r[1],i=Object(n.useState)(Object(X.a)(t.slice(0,5))),u=Object(E.a)(i,2),s=u[0],d=u[1],m=Object(n.useState)(!1),p=Object(E.a)(m,2),f=p[0],v=p[1],b=Object(n.useState)(void 0),h=Object(E.a)(b,2),O=h[0],g=h[1],y=Object(n.useContext)(Ve),j=y.state,C=y.dispatch,w=function(){o(!0),nt(Object(Z.a)({},j.search_query,{page:j.page,pagesize:j.pagesize})).then((function(e){C({type:"SET_LIST",payload:e.data.data}),C({type:"SET_TOTAL",payload:e.data.total})})).finally((function(){o(!1)}))};Object(n.useEffect)((function(){w()}),[j.page,j.pagesize,j.search_query]);var S=[{title:"\u5e8f\u53f7",dataIndex:"order",render:function(e,t,a){return a+1}}].concat(Object(X.a)(s),[{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(te.a,{type:"link",onClick:function(){var e;o(!0),(e=t.id,B({url:"/v1/poc/".concat(e,"/"),method:"get"})).then((function(e){g(e.data||t),k()})).finally((function(){o(!1)}))}},"\u8be6\u60c5"),l.a.createElement(ve.a,{title:"\u771f\u7684\u5220\u9664\uff1f",onCancel:function(){},onConfirm:function(){T(t.id)}},l.a.createElement(te.a,{type:"link"},"\u5220\u9664")))}}]),k=function(){v((function(e){return e&&g(void 0),!e}))},T=function(e){o(!0),function(e){return B({url:"/v1/poc/".concat(e),method:"delete"})}(e).then((function(e){A.a.success("\u5220\u9664\u6210\u529f"),w()})).finally((function(){o(!1)}))},I=document.documentElement.offsetWidth;return l.a.createElement("div",{className:"vul-manage-table"},l.a.createElement("div",{className:"vul-controller"},l.a.createElement(pe.a,null,l.a.createElement(te.a,{icon:l.a.createElement(ne.PlusOutlined,null),type:"primary",onClick:k},"\u65b0\u5efapoc")),l.a.createElement(je,{className:"custom-btn",allColumns:t,columns:s,setColumns:d})),l.a.createElement(de.a,{columns:S,dataSource:j.list,rowKey:"id",loading:c,pagination:{current:j.page,pageSize:j.pagesize,total:j.total,showTotal:function(e){return"\u5171".concat(e,"\u6761")},showQuickJumper:!0,showSizeChanger:!0,onChange:function(e,t){C({type:"SET_PAGINATION",payload:{page:e,pagesize:t}})}}}),f&&l.a.createElement(ct,{visible:f,onCancel:k,title:O?"poc\u8be6\u60c5":"\u65b0\u589epoc",width:I,wrapClassName:"add-vul-wrap",selected:O,type:"vul"}))},it=function(e,t){var a=t.type,n=t.payload;switch(a){case"SET_SEARCH_QUERY":return Object(Z.a)({},e,{search_query:n,page:1});case"SET_PAGINATION":return Object(Z.a)({},e,{page:n.page,pagesize:n.pagesize});case"SET_BASIC":return Object(Z.a)({},e,{basic:n});case"SET_LIST":return Object(Z.a)({},e,{list:n});case"SET_TOTAL":return Object(Z.a)({},e,{total:n});case"SET_MODULE_LIST":return Object(Z.a)({},e,{moduleList:n});case"SET_SCRIPT_LIST":return Object(Z.a)({},e,{scriptList:n});case"SET_PRODUCT_LIST":return Object(Z.a)({},e,{productList:n});case"TOGGLE_FLAG":return Object(Z.a)({},e,{flag:!e.flag});default:throw new Error("action type error")}},ut=[{path:"/login",key:"/login",component:le,hidden:!0},{path:"/vul",key:"/vul",component:ze,meta:{name:"\u6f0f\u6d1e\u63cf\u8ff0",icon:"icon-chakan-copy"}},{path:"/poc",key:"/poc",component:function(e){var t=Object(n.useReducer)(it,Me),a=Object(E.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){Ae().then((function(e){c({type:"SET_BASIC",payload:e.data})})),ke({page:1,pagesize:9999}).then((function(e){c({type:"SET_PRODUCT_LIST",payload:e.data.data})}))}),[]),l.a.createElement(Ve.Provider,{value:{state:r,dispatch:c}},l.a.createElement("div",{className:"vul-manage-wrap"},l.a.createElement(Ge,null),l.a.createElement(ot,null)))},meta:{name:"\u6f0f\u6d1e\u89c4\u5219",icon:"icon--_xitongrizhi"}}];var st=function e(t){for(var a=[],n=0;n<t.length;n++){var l=t[n];a.push(Object(Z.a)({},l)),(null===l||void 0===l?void 0:l.subMenu)&&a.push.apply(a,Object(X.a)(e(l.subMenu)))}return a}(ut),dt=a(2346),mt=Object(dt.a)({scriptUrl:"//at.alicdn.com/t/font_1871150_pfyscyl84i.js"}),pt=v.a.Sider,ft=k.a.SubMenu,vt=function(e){var t=Object(p.g)().location.pathname,a=Object(n.useState)([]),r=Object(E.a)(a,2),c=r[0],o=r[1],i=Object(n.useContext)(_).state;Object(n.useEffect)((function(){o([t])}),[t]);var u=Object(n.useMemo)((function(){return ut.filter((function(e){return!e.hidden})).map((function(e){var t,a,n,r;if(!e.subMenu)return l.a.createElement(k.a.Item,{key:e.key,className:"side-item-wrap"},l.a.createElement(m.b,{to:e.path},l.a.createElement(mt,{type:null===e||void 0===e||null===(n=e.meta)||void 0===n?void 0:n.icon}),l.a.createElement("span",null,null===e||void 0===e||null===(r=e.meta)||void 0===r?void 0:r.name)));var c=l.a.createElement("span",null,l.a.createElement(mt,{type:null===e||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.icon}),l.a.createElement("span",null,null===e||void 0===e||null===(a=e.meta)||void 0===a?void 0:a.name)),o=null===e||void 0===e?void 0:e.subMenu.filter((function(e){return!e.hidden})).map((function(e){return l.a.createElement(k.a.Item,{key:e.key,className:"side-item"},l.a.createElement(m.b,{to:e.path},l.a.createElement("span",null,e.meta.name)))}));return l.a.createElement(ft,{key:null===e||void 0===e?void 0:e.key,title:c},o)}))}),[]);return l.a.createElement(pt,{trigger:null,collapsible:!0,collapsed:i.collapsed,width:210},l.a.createElement("h2",{className:"logo"},"POC ASSIST"),l.a.createElement(k.a,{theme:"dark",mode:"inline",selectedKeys:c},u))},Et=function(e){return l.a.createElement(p.d,null,st.filter((function(e){return null===e||void 0===e?void 0:e.component})).map((function(e){var t=e.component;return l.a.createElement(p.b,{exact:!0,key:e.key,path:e.path,render:function(e){return l.a.createElement(t,e)}})})),l.a.createElement(p.a,{from:"/",to:"/login",push:!0}))},bt=function(e,t){switch(t.type){case"TOGGLE_COLLAPSED":return Object(Z.a)({},e,{collapsed:!e.collapsed});default:throw new Error("action type error")}},ht=function(e){return"/login"!==Object(p.h)().pathname?l.a.createElement(p.a,{to:"/login",push:!0}):l.a.createElement(p.b,null,l.a.createElement(v.a,{className:"un-auth-layout"},l.a.createElement(Et,null)))},Ot=function(e){var t=Object(n.useReducer)(bt,F),a=Object(E.a)(t,2),r=a[0],c=a[1],o=U(),i=Object(p.h)();return o&&"/login"!==i.pathname?l.a.createElement(_.Provider,{value:{state:r,dispatch:c}},l.a.createElement(v.a,null,l.a.createElement(vt,null),l.a.createElement(v.a,{className:"main-wrap"},l.a.createElement(K,null),l.a.createElement("div",{className:"main-content"},l.a.createElement(Et,null))))):l.a.createElement(ht,null)};a(2335);var gt=function(){return l.a.createElement(l.a.Suspense,{fallback:l.a.createElement(s.a,{size:"large",className:"app-loading"})},l.a.createElement(i.a,{locale:d.a},l.a.createElement(m.a,{basename:"/"},l.a.createElement(p.d,null,l.a.createElement(Ot,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(gt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},326:function(e,t,a){},384:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAYAAADFeBvrAAAAAXNSR0IArs4c6QAACYRJREFUaAXdWltMVdkZ/ve5cACH+03kfgdtSxsKiEIFSY3GamYcp4kmxBdf9KG+NLaZp/GlaTUmpA+m76axMlaaMfFSZwRHDcKoDTUKCD0Ccr8OMFzOhbP7f+ucfdgczmUfYDKDf7LPXntd/vV96/qv9R+JNlHKf/VxnsNhqyGdXEwyFbDqbH4iZZkiUI0k0Ry/Zvkxk0Rd5JDadTpjU+vX/+xG+maItFElZTUfFcs2ex0D/K0sy2nr0SdJ0jtugAbJaLja1tTYvh4dSpl1E6qo+rDMJtv/woqqFWV4yw4HWSyLZF1aEG/L0jyNDr4VWZJSssgUuo1MpjAKCQ0Xb0mnUxdHuNkoGf7Q8uhfbZ4JWr6DJlRRfTTXbpf/JJP8iVLBst1GczOT9O30GM3PTpOFyTgcy0qy17dOp2dy4bQtMoaiYxIpIiqO9AajO69E0ucGg/RpS/MXPe5IDQHNhKqrPzPM25//WSb6HfeDqBnAJ0b6aWpiSJDQUJ/PLCAXG7+D4renC6LOjJKNAf51m6Hkj83Nn9l9FlYlaCJUVvtRnMNi/5yJ1KCs3WblYWSmcSZjt1tV6jYeNBhCKIFJJaVkk8EY4lIoNelMhk/avmqcDFRDQEKlNUd2kU3+gnsGKxZ9OzVKA287aGnxu0C6N5QeGvYBpWYVUXRsktDDQM1klI5+03TrlT/Fen+J5fuO/lq207+ZzHZewWiov4vemV+JHvJXbjPS0PPTE8Mkyw4xv3jNj5EcUl1aVuGzwb4us686fPaQs2eohSd/xPKynfq6/yvmii9F32c85lZG3s9Irzfw7iDNkZEqfPWUV0KYM7LF1oZh5mAy/+v6D83wUPshJYqHXk7BL0gnSJFZMhnLvM2pNZsAVjMsACCDYdbLPfNDk0FDAgOwAJNoaMYIrJ6NvCYCS7OymmHOYEkOVgwGA8XHx1NaWhrl5eVRenq6UNHf3089PT2E98TEBK+QmlZid/XAYgoLp5SMQo6Ta5xY6ffuDBxYNeSwadrs8mvsMzNTY9TT8Y1oEXUBdViv11NCQoIADOBFRUVUWFhIubm5lJqaSrGxsTyXV1Uh9E1NTdHAwIAg19nZSR0dHdTd3S2Ijo+P0/Ky700Z+nKLSikqNhHwbUaDtNPn5ltaeaThl5W/kX+++4AcGraNexa96/05ePCg/OzZM5lbmq0dB4+EjQl0QBd0QrevehEPbMAIrMDMcW5xN5/LNmtFymBvJw0P+Lc47t27RwcOHHAr2szA3bt36dChQ35VJqfmUkomhh7x9mQoV2w/96LgMjSFCTM20udXmVBiXLG7AmYOMoNurcG6RgMwwvSCKNgRFoRwBOBwNSJgm8HYDCQ8wAJlWXe6Ft3ACKwuqXZxcBIS5xlOWeZVZ3J8UMn0o38DKzBDFA7OIceHM0TOzUyQlc8yW0WAFZiFuDjocGzmLhYnTZxntpoomMEBXHTiDoBZ4KSJw5laTp48SU+ePKHz589TQQGuCFZEyzhfyR1cyFN3fn6+wAAswKQWYAZ2CLgYxIUGf1uti+5VQymQnJxMFRUVtGfPHrpw4QI9ffqUHjx4QI8fP6bw8HAl26a/obumpoYqKytp//79tHv3bgoNDRWb8s2bN1fVh5UO2HG0BxeptOrIl9witbPT4/TmldiG3AWwfFZVVdGJEyeINzthEWCnRgt6WgDuQpsUUOrAG6YS9qZr167Ro0ePuCecPaJUlb+rnCJjEoDpK9hy2UgAS09BwYcPH4onKiqKSkpKaN++faLXYOKgB2H+bBY5gIfZMzIyIsyhlpYWUffz589pZmbGE577W4U9G4QikbK0OO/O4C0AhRhueCDR0dGUkZEh7DbYbgjv2LFD2HYgj2FjMpkIhipIQwAWBqnFYqGFhQUBErbb0NAQ9fX1CdsOxmtvb69fAkKZ6keFPdLAjSIuAXFHoFWMbCWAQHt7u3g8yyE9JCREPCCk9CB6AISsVqt4bDbvG/jOnTtpfn5eszUO7KmZRTwVKMK5D3kiCvCNlj537hxlZmZ6zQmgADQ9PU3oAfWDOKT5IpOVlSV0+7O4vVbqitTxHMf1rLhl8ZdRnYa5haW0oaFBnHfUaZ5hnIvu378vHoT9CY4g169fF7rRm1oFN0QQcMEcwl1zHJvkiNMsmAd79+4V+9SNGzeotbWVXr9+LcY/egQCAlevXqXa2lrxjXBdXZ043CECZyn0MoZYeXk5HT9+XMTBkg9GVNhnQQiTJyskJCwYHe68AHXmzBnxoFXHxsbIbDbT8PAwFRcXU05Ojjsvln7sZZh7WCGzs7MpMTHRPcfcGYMMqLCbcY3SxUe4WhxtcT0b6ArXX12Y/ElJSeLxlQ8E1SR95dMaD8zALoS56ODSwAdY4jp2qwkwu3tIuGfYPwMS8ALg4nyrCTArHgz4mnRwNvFQeQci8AJsNVEwgwO4OPchdjaBSERUPIWw70aLaDkma9HjLY9W3cAKzEJcHAQheM4QqeddPS4hxZkhwO/o6GiAHOtPnpwM6GQQyoEVmCEKB0HI5QZsRgL8M2rHE+K8ycWLF8Xy7C1tI3FY8i9duhRQBTACq0uaFVemc8hxLNyASMSqkbg9w5XP9+vFixfivFJfX0+Li2stdd8lvadAB3ThDATdgQQYlVVZwb6mTDAXjVwYtol4ysrK5Dt37qzrwhEXjCgLHYq+QG9/F43uHmIlbOpLn/JotMGLlpa1S/MO3tbWRocPHxZmzZs3b6BKkyAvTCGUhQ4tgs0b2IDRiRWYV0S/EiQa6O2aSkkviOK4PbCP4Gz6bnZKncVnGGbPy5cvxakSRwSYPTgPeZPZ2Vm6fPkynT59WtiAwRiiyWm5lJDsnBLsK6pv/frWP9R1rCKEhPzskw+sjuEqDmbBM23hg9/igjDI1eV8hjEXcAi8ffu2MIFwskWrQgC8sbGRTp06JYgHO/fg+ErP+YlLn9T0gaHkVG9vs0MNxlmTOobDm+nwOnbsGJ09e1bUcOXKFfK85PCo2uenVoeXV0LQulVdkmuGnNJEQ71vxuGg5XXsQ7aVTNFx2zlJpvm51Xd3Sv7v442hijmDYQarGv5VnV76uK351lNf9fnsIaXAVnPrByQEYlvpjxc+h5zSQ3gPvu1c5NXv7zbHMJ/TpVId30tFRsdTTDzfy/FQsFmXNLlg1Do9w4qFkpH7U6GX6+As+GuMVI/V7EnT3/zfs7kUauohdeXvzZ+X1KQQfm/+XuZJ7L35A6AnMXz/GP6i+X8C8EVD2PN7kQAAAABJRU5ErkJggg=="},394:function(e,t,a){e.exports=a(2337)},399:function(e,t,a){},404:function(e,t){function a(){var e=document.documentElement.clientWidth/1920;document.documentElement.style.fontSize=192*e+"px"}a(),window.addEventListener("resize",(function(){a()}))},625:function(e,t,a){}},[[394,1,2]]]);